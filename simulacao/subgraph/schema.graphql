type Proposal @entity {
  id: ID! # proposalId
  proposalId: BigInt!
  proposer: Bytes!
  title: String!
  ipfsHash: String!
  voteType: VoteType!
  startTime: BigInt!
  endTime: BigInt!
  votesFor: BigInt!
  votesAgainst: BigInt!
  votersFor: BigInt!
  votersAgainst: BigInt!
  totalVoters: BigInt!
  quorumRequired: BigInt!
  state: ProposalState!
  createdAt: BigInt!
  executedAt: BigInt
  votes: [Vote!]! @derivedFrom(field: "proposal")
  tags: ProposalTag
}

type ProposalTag @entity {
  id: ID! # proposalId
  proposal: Proposal!
  isProcedural: Boolean!
  isResourceAllocation: Boolean!
  isTechnical: Boolean!
  isEthical: Boolean!
  budgetImpact: BigInt!
  requiresExpertise: Boolean!
  expertDomain: Bytes!
}

type Vote @entity {
  id: ID! # proposalId-voter
  proposal: Proposal!
  voter: Bytes!
  support: Boolean!
  weight: BigInt!
  voteType: VoteType!
  timestamp: BigInt!
  transactionHash: Bytes!
}

type Expert @entity {
  id: ID! # expert-domain
  expert: Bytes!
  domain: Bytes!
  verifiedAt: BigInt!
  verifier: Bytes!
}

type Voter @entity {
  id: ID! # address
  address: Bytes!
  totalVotes: BigInt!
  proposalsCreated: BigInt!
  proposalsVoted: [Proposal!]!
  votes: [Vote!]! @derivedFrom(field: "voter")
  isExpert: Boolean!
  expertDomains: [Bytes!]!
}

type GovernanceStats @entity {
  id: ID! # "governance-stats"
  totalProposals: BigInt!
  activeProposals: BigInt!
  succeededProposals: BigInt!
  defeatedProposals: BigInt!
  totalVotes: BigInt!
  totalVoters: BigInt!
  linearProposals: BigInt!
  quadraticProposals: BigInt!
  logarithmicProposals: BigInt!
  consensusProposals: BigInt!
  lastUpdateBlock: BigInt!
  lastUpdateTimestamp: BigInt!
}

enum VoteType {
  LINEAR
  QUADRATIC
  LOGARITHMIC
  CONSENSUS
}

enum ProposalState {
  PENDING
  ACTIVE
  SUCCEEDED
  DEFEATED
  EXECUTED
}
